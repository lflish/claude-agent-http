# Claude Agent HTTP Configuration

# User directory configuration
user:
  base_dir: "~/claude-agent-http/"  # Base directory for all users
  auto_create_dir: true          # Auto-create user directories

# Session storage configuration
session:
  storage: "memory"                # memory | sqlite | postgresql
  ttl: 1800                        # Session TTL in seconds (0 = no expiration)
  sqlite_path: "sessions.db"       # SQLite database path
  # PostgreSQL settings (when storage: postgresql)
  pg_host: "localhost"
  pg_port: 5432
  pg_database: "claude_agent"
  pg_user: "postgres"
  pg_password: "postgres"

# API server configuration
api:
  host: "0.0.0.0"
  port: 8000
  cors_origins:
    - "*"
  max_sessions: 20
  max_sessions_per_user: 5
  max_concurrent_requests: 5
  memory_limit_mb: 7168         # Refuse new sessions above this threshold (MB, within container 8G limit)
  idle_session_timeout: 600     # Evict idle in-memory clients after 10 minutes

# Default values for new sessions
defaults:
  system_prompt: "You are a helpful AI assistant."
  permission_mode: "bypassPermissions"
  allowed_tools:
    - "Bash"
    - "Read"
    - "Write"
    - "Edit"
    - "Glob"
    - "Grep"
    - "Skill"
  setting_sources:               # Load Skills from filesystem
    - "user"                     # ~/.claude/skills/ (personal skills)
    - "project"                  # .claude/skills/ (project skills)
  cli_path: "/usr/local/bin/claude"  # Use npm-installed claude (Bun bundled crashes without AVX)
  model: null                    # Model to use (null = SDK default)
  max_turns: 50                  # Max conversation turns (lower = less memory per session)
  max_budget_usd: null           # Max budget in USD (null = unlimited)

# Global MCP servers (applied to all sessions)
mcp_servers:
  # Playwright MCP server - Browser automation (globally installed, no npm exec overhead)
  playwright:
    type: "stdio"
    command: "playwright-mcp"
    args: []

  # Filesystem MCP server - File system access (globally installed, no npm exec overhead)
  filesystem:
    type: "stdio"
    command: "mcp-server-filesystem"
    args:
      - "/data/claude-users"

  # Remote Exec MCP server - SSE type
  remote_exec:
    type: "sse"
    url: "http://10.1.16.4:8000/mcp/sse"

# Global plugins (SDK-level plugins, different from Skills)
# For Skills, use setting_sources in defaults section above
plugins: []

  # Example configurations (uncomment to use):
  # System-level skills (from Claude data directory)

  # Project-level skills (from repository)
  #- type: "local"
  #  path: "/app/skills"

  # Note: Skills directories will be scanned for all available skills
  # Each skill should follow the Claude Agent SDK plugin structure
  # System skills are loaded from the mounted ~/.claude-data volume
  # Project skills are included in the Docker image
